rule_id: APT29_Credential_Exfiltration_GitHub
name: APT29 Credential Exfiltration via GitHub
description: >
  Detects attempts to retrieve tools or exfiltrate credentials using PowerShell/CMD to access raw.githubusercontent.com, specifically targeting PasswordVaultCredentials. This TTP is associated with APT29/Nobelium campaigns.
type: query
language: kuery

query: |
  (process.args: "powershell.exe" or process.args: "cmd.exe") and (message : "IEX" or message:"IWR") and message: "raw.githubusercontent.com" and message: "PasswordVaultCredentials"

index:
  - .ds-logs-endpoint.events.process-*
  - .ds-logs-windows.sysmon-*
  - .ds-logs-system.security-*
  - .ds-logs-windows.powershell-*
  - logs-*
  - .ds-logs*

severity: high
risk_score: 70

enabled: true

tags:
  - attack.credential_access
  - attack.t1552.001
  - apt29

references:
  - https://attack.mitre.org/techniques/T1552/001/

author: 
  - Gabriel_binion
version: 1.0